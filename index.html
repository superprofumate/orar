<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Orar disponibilitƒÉ»õi | Luni‚ÄìVineri 07:00‚Äì21:00</title>
  <meta name="description" content="SelecteazƒÉ intervalele orare disponibile (Luni‚ÄìVineri, 07:00‚Äì21:00). Include nume, resetare, undo, salvare »ôi trimitere." />
  <meta name="robots" content="noindex, nofollow" />
  <style>
    :root{
      --bg:#0b1220; /* albastru-√Ænchis subtil */
      --panel:#0f172a; /* slate-900 */
      --muted:#94a3b8; /* slate-400 */
      --text:#e5e7eb; /* zinc-200 */
      --accent:#22d3ee; /* cyan-400 */
      --accent-2:#4f46e5; /* indigo-600 */
      --danger:#ef4444;
      --ok:#22c55e;
      --grid:#1f2937; /* gray-800 */
      --sel-bg:rgba(34, 211, 238, .2);
      --sel-br:#22d3ee;
      --radius:16px;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --maxw:1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 800px at 20% -10%, #111827 0%, var(--bg) 40%, #05070c 100%); font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:var(--text);}
    a{color:inherit;text-decoration:none}

    .container{max-width:var(--maxw);margin:0 auto;padding:20px}
    header{position:sticky;top:0;background:linear-gradient(180deg, rgba(5,7,12,.9), rgba(5,7,12,.65));backdrop-filter: blur(6px);z-index:20;border-bottom:1px solid #0b1220}
    .brand{font-weight:800;letter-spacing:.3px;font-size:18px;display:flex;align-items:center;gap:10px}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:var(--accent);box-shadow:0 0 14px var(--accent)}
    .nav{display:flex;align-items:center;justify-content:space-between}

    .panel{margin-top:18px;background:linear-gradient(180deg, #0e162a, #0a1222);border:1px solid #0f2139;border-radius:var(--radius);box-shadow:var(--shadow)}
    .panel .inner{padding:18px}

    .toolbar{display:grid;gap:12px}
    @media (min-width: 820px){ .toolbar{grid-template-columns: 1.5fr auto auto auto auto} }

    label{font-size:14px;color:var(--muted)}
    input[type="text"]{width:100%;padding:12px 14px;border-radius:12px;background:#0b1323;border:1px solid #14233c;color:var(--text);outline:none}
    input[type="text"]:focus{border-color:#1d3d6b;box-shadow:0 0 0 3px rgba(79,70,229,.25)}

    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;border:1px solid #20304a;background:#0b1323;color:var(--text);cursor:pointer;user-select:none;transition:transform .05s ease, background .2s}
    .btn:hover{background:#0f1a31}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:linear-gradient(135deg, #2563eb, #06b6d4);border-color:#1d4ed8}
    .btn.primary:hover{filter:brightness(1.05)}
    .btn.ok{background:#11261a;border-color:#1f6f3a}
    .btn.danger{background:#2a1212;border-color:#7f1d1d}
    .btn:disabled{opacity:.5;cursor:not-allowed}

    .grid-wrap{overflow:auto;border-top:1px solid #0b1220;border-radius:0 0 var(--radius) var(--radius)}
    .grid{display:grid;grid-template-columns: 110px repeat(5, 1fr); min-width:720px}

    .cell{border-right:1px solid var(--grid);border-bottom:1px solid var(--grid);min-height:38px;display:grid;place-items:center;position:relative}
    .cell.head{background:#0a1220;color:#cbd5e1;font-weight:700;position:sticky;top:0;z-index:5}
    .cell.hour{background:#0a1220;color:#9aa6b2;font-weight:600;justify-content:start;padding-left:12px;position:sticky;left:0;z-index:4}
    .cell.slot{cursor:pointer}
    .cell.slot:focus{outline:2px solid #334155;outline-offset:-4px}
    .cell.slot.selected{background:var(--sel-bg); box-shadow: inset 0 0 0 2px var(--sel-br)}

    .legend{display:flex;align-items:center;gap:10px;font-size:13px;color:var(--muted);margin-top:8px}
    .swatch{width:14px;height:14px;border-radius:4px;box-shadow:0 0 0 2px var(--sel-br) inset;background:var(--sel-bg)}

    .status{margin-top:10px;font-size:14px;color:var(--muted)}

    .toast{position:fixed;right:20px;bottom:20px;display:grid;gap:10px;z-index:50}
    .toast .t{padding:12px 14px;background:#0b1323;border:1px solid #1d2d4a;border-radius:12px;box-shadow:var(--shadow)}
    .t.ok{border-color:#1f6f3a}
    .t.err{border-color:#7f1d1d}

    footer{color:var(--muted);font-size:12px;padding:18px; text-align:center}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><span class="dot"></span> Orar disponibilitƒÉ»õi</div>
      <div style="font-size:12px;color:var(--muted)">Luni‚ÄìVineri ‚Ä¢ 07:00‚Äì21:00 ‚Ä¢ selec»õie multiplƒÉ</div>
    </div>
  </header>

  <main class="container">
    <section class="panel">
      <div class="inner">
        <div class="toolbar">
          <div>
            <label for="name">Nume</label>
            <input id="name" type="text" placeholder="Introdu numele (obligatoriu pentru trimitere)" />
          </div>
          <button id="undoBtn" class="btn" disabled>‚Ü∂ Undo</button>
          <button id="resetBtn" class="btn danger">ReseteazƒÉ orar</button>
          <button id="saveBtn" class="btn">üíæ SalveazƒÉ modificƒÉri</button>
          <button id="sendBtn" class="btn primary" disabled>‚úàÔ∏è Trimite date</button>
        </div>
        <div class="legend"><span class="swatch"></span> Slot selectat (click pentru a comuta; click + drag pentru selec»õie continuƒÉ)</div>
        <div class="status" id="status">0 sloturi selectate</div>
      </div>
      <div class="grid-wrap">
        <div id="grid" class="grid" aria-label="Orar selectabil Luni‚ÄìVineri, 07:00‚Äì21:00" role="grid"></div>
      </div>
    </section>

    <footer>¬© <span id="y"></span> Orar disponibilitƒÉ»õi. Datele se pƒÉstreazƒÉ local (localStorage).</footer>
  </main>

  <div class="toast" id="toast"></div>

  <script>
    (function(){
      const days = ["Luni","Mar»õi","Miercuri","Joi","Vineri"]; // coloane
      const startHour = 7; // 07:00 inclusiv
      const endHour = 21; // 21:00 exclusiv (ultimul slot 20:00‚Äì21:00)

      const grid = document.getElementById('grid');
      const nameInput = document.getElementById('name');
      const undoBtn = document.getElementById('undoBtn');
      const resetBtn = document.getElementById('resetBtn');
      const saveBtn = document.getElementById('saveBtn');
      const sendBtn = document.getElementById('sendBtn');
      const status = document.getElementById('status');
      const toast = document.getElementById('toast');

      const keyOf = (d,h) => `${d}|${String(h).padStart(2,'0')}:00`;

      // stare curentƒÉ
      const selected = new Set();
      let dragging = false;
      let dragMode = null; // 'select' sau 'deselect'
      let currentBatch = [];
      const history = []; // stivƒÉ de ac»õiuni {changes:[{id, prev, next}]}

      // Construie»ôte headerul
      const emptyHead = cell('head', '');
      grid.appendChild(emptyHead);
      days.forEach(d => grid.appendChild(cell('head', d)));

      // Construie»ôte r√¢ndurile ore
      for (let h = startHour; h < endHour; h++){
        const label = `${String(h).padStart(2,'0')}:00`;
        grid.appendChild(cell('hour', label));
        for (let d = 0; d < days.length; d++){
          const id = keyOf(days[d], h);
          const c = cell('slot', '');
          c.tabIndex = 0; // focusabil pt accesibilitate
          c.dataset.id = id;
          c.setAttribute('role','gridcell');
          c.setAttribute('aria-label', `${days[d]} ${label}`);
          c.addEventListener('mousedown', onMouseDown);
          c.addEventListener('mouseenter', onMouseEnter);
          c.addEventListener('click', onClick); // backup pt tap
          c.addEventListener('keydown', onKey);
          grid.appendChild(c);
        }
      }

      function cell(kind, text){
        const div = document.createElement('div');
        div.className = `cell ${kind}`;
        if (text) div.textContent = text;
        return div;
      }

      function setSelected(id, val){
        const el = findCell(id);
        const was = selected.has(id);
        if (val && !was){ selected.add(id); el.classList.add('selected'); return true; }
        if (!val && was){ selected.delete(id); el.classList.remove('selected'); return true; }
        return false;
      }

      function findCell(id){
        return grid.querySelector(`.cell.slot[data-id="${CSS.escape(id)}"]`);
      }

      function beginBatch(){ currentBatch = []; }
      function recordChange(id, prev, next){ if (prev !== next) currentBatch.push({id, prev, next}); }
      function endBatch(){ if (currentBatch.length){ history.push({changes: currentBatch}); currentBatch = []; refreshUndo(); } }

      function onMouseDown(e){
        if (!e.currentTarget.classList.contains('slot')) return;
        e.preventDefault();
        dragging = true;
        document.body.style.userSelect = 'none';
        const id = e.currentTarget.dataset.id;
        const was = selected.has(id);
        dragMode = was ? 'deselect' : 'select';
        beginBatch();
        const changed = setSelected(id, dragMode === 'select');
        recordChange(id, was, !was);
        updateStatus();
      }

      function onMouseEnter(e){
        if (!dragging) return;
        if (!e.currentTarget.classList.contains('slot')) return;
        const id = e.currentTarget.dataset.id;
        const was = selected.has(id);
        const want = dragMode === 'select';
        const changed = setSelected(id, want);
        if (changed) recordChange(id, was, want);
        updateStatus();
      }

      function onClick(e){ // single click tap (fƒÉrƒÉ drag)
        // dacƒÉ a fost drag adevƒÉrat, evenimentul click vine oricum, dar nu vrem sƒÉ dublem
        if (dragging) return;
        const id = e.currentTarget.dataset.id;
        const was = selected.has(id);
        beginBatch();
        const changed = setSelected(id, !was);
        recordChange(id, was, !was);
        endBatch();
        updateStatus();
      }

      function onKey(e){
        if (e.key === ' ' || e.key === 'Enter'){
          e.preventDefault();
          const id = e.currentTarget.dataset.id;
          const was = selected.has(id);
          beginBatch();
          setSelected(id, !was);
          recordChange(id, was, !was);
          endBatch();
          updateStatus();
        }
      }

      document.addEventListener('mouseup', ()=>{
        if (dragging){ dragging = false; document.body.style.userSelect = ''; endBatch(); updateStatus(); }
      });

      // Undo
      undoBtn.addEventListener('click', ()=>{
        const act = history.pop();
        if (!act) return;
        act.changes.slice().reverse().forEach(ch => { setSelected(ch.id, ch.prev); });
        refreshUndo();
        updateStatus();
      });

      function refreshUndo(){ undoBtn.disabled = history.length === 0; }

      // Reset
      resetBtn.addEventListener('click', ()=>{
        beginBatch();
        [...selected].forEach(id => { recordChange(id, true, false); setSelected(id, false); });
        endBatch();
        updateStatus();
      });

      // Save (localStorage)
      saveBtn.addEventListener('click', ()=>{
        const data = serialize();
        try{
          localStorage.setItem('orarData', JSON.stringify(data));
          toastMsg('ModificƒÉri salvate local.', 'ok');
        }catch(err){ toastMsg('Nu s-a putut salva local.', 'err'); }
      });

      // Send (fake submit)
      sendBtn.addEventListener('click', ()=>{
        const data = serialize();
        if (!data.nume){ nameInput.focus(); toastMsg('Te rog introdu numele √Ænainte de trimitere.', 'err'); return; }
        if (data.sloturi.length === 0){ toastMsg('SelecteazƒÉ cel pu»õin un slot.', 'err'); return; }
        // Aici ai JSON-ul pregƒÉtit de trimitere:
        // console.log('Payload de trimis', data);
        toastMsg('Trimitere cu succes!', 'ok');
      });

      function serialize(){
        const nume = nameInput.value.trim();
        const slots = [...selected].map(id => {
          const [zi, ora] = id.split('|');
          const h = parseInt(ora.slice(0,2),10);
          const start = `${String(h).padStart(2,'0')}:00`;
          const end = `${String(h+1).padStart(2,'0')}:00`;
          return { zi, start, end };
        }).sort((a,b)=> days.indexOf(a.zi)-days.indexOf(b.zi) || a.start.localeCompare(b.start));
        return { nume, sloturi: slots };
      }

      function updateStatus(){
        const n = selected.size;
        status.textContent = `${n} ${n===1? 'slot selectat' : 'sloturi selectate'}`;
        sendBtn.disabled = !(nameInput.value.trim() && n>0);
      }

      nameInput.addEventListener('input', updateStatus);

      function toastMsg(msg, type='ok'){
        const el = document.createElement('div');
        el.className = `t ${type}`;
        el.textContent = msg;
        toast.appendChild(el);
        setTimeout(()=>{ el.style.opacity='0'; el.style.transform='translateY(4px)'; el.style.transition='all .4s'; }, 2500);
        setTimeout(()=>{ toast.removeChild(el); }, 3000);
      }

      function restore(){
        try{
          const raw = localStorage.getItem('orarData');
          if (!raw) return;
          const data = JSON.parse(raw);
          if (data.nume) nameInput.value = data.nume;
          if (Array.isArray(data.sloturi)){
            data.sloturi.forEach(s => {
              const h = parseInt(s.start.slice(0,2),10);
              const id = keyOf(s.zi, h);
              const el = findCell(id);
              if (el) setSelected(id, true);
            });
          }
        }catch(e){}
        updateStatus();
      }

      restore();
      document.getElementById('y').textContent = new Date().getFullYear();
    })();
  </script>
</body>
</html>
